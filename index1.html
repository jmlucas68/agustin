<script>
document.addEventListener('DOMContentLoaded', function () {
    // Cargar obras desde obras.json modificado
    fetch('obras.json')
        .then(response => {
            if (!response.ok) throw new Error('Error en la red: ' + response.statusText);
            return response.json();
        })
        .then(obrasData => {
            const container = document.getElementById('obras-container');
            if (container) {
                let html = '';
                obrasData[0].obras.forEach(obra => {
                    html += `<div style="margin-bottom: 1.5rem;">`;
                    html += `<h4 style="color:#8b4513; font-size:1.3rem; margin-bottom:0.5rem;">${obra.titulo}</h4>`;
                    html += `<ul style="padding-left:1.5rem; list-style:disc;">`;
                    obra.enlaces.forEach(enlace => {
                        html += `<li><a href="${enlace.url}" target="_blank" style="color: #0077cc; text-decoration: underline;">${enlace.texto}</a></li>`;
                    });
                    html += `</ul></div>`;
                });
                container.innerHTML = html;
            }
        })
        .catch(error => {
            console.error('Error al cargar obras:', error);
            document.getElementById('obras-container').innerHTML =
                '<p style="color:red;">No se pudieron cargar las obras. Asegúrate de que "obras.json" está en el mismo directorio.</p>';
        });

    // Navegación suave
    document.querySelectorAll('nav a').forEach(link => {
        link.addEventListener('click', function (e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            const targetSection = document.getElementById(targetId);
            if (targetSection) {
                targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

                document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
                this.classList.add('active');
            }
        });
    });

    // Marcar sección activa según scroll
    window.addEventListener('scroll', function () {
        const sections = document.querySelectorAll('section[id]');
        const navLinks = document.querySelectorAll('nav a');

        let current = '';
        sections.forEach(section => {
            const sectionTop = section.offsetTop - 100;
            if (scrollY >= sectionTop) {
                current = section.getAttribute('id');
            }
        });

        navLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href').substring(1) === current) {
                link.classList.add('active');
            }
        });
    });
});
</script>
